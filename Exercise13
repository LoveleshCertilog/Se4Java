<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>org.example</groupId>
    <artifactId>TestAutomation</artifactId>
    <version>1.0-SNAPSHOT</version>

    <properties>
        <maven.compiler.source>21</maven.compiler.source>
        <maven.compiler.target>21</maven.compiler.target>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>
    <dependencies>
    <dependency>
        <groupId>org.seleniumhq.selenium</groupId>
        <artifactId>selenium-java</artifactId>
        <version>4.19.1</version>
    </dependency>

        <dependency>
            <groupId>io.github.bonigarcia</groupId>
            <artifactId>webdrivermanager</artifactId>
            <version>5.7.0</version>
        </dependency>

        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-chrome-driver</artifactId>
            <version>4.19.1</version>
        </dependency>

        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>7.4.0</version>
        </dependency>

        <dependency>
            <groupId>com.aventstack</groupId>
            <artifactId>extentreports</artifactId>
            <version>5.1.1</version>
        </dependency>

    </dependencies>
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>21</source>
                    <target>21</target>
                    <compilerArgs>--enable-preview</compilerArgs>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>


package org.example;
import java.io.File;
import java.lang.*;

import static java.lang.Thread.sleep;
import static org.openqa.selenium.support.locators.RelativeLocator.with;

import com.aventstack.extentreports.*;
import com.aventstack.extentreports.reporter.ExtentSparkReporter;
import com.aventstack.extentreports.reporter.configuration.Theme;
import org.apache.commons.io.FileUtils;
import org.openqa.selenium.*;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;

import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;
import org.testng.asserts.SoftAssert;
import org.testng.Assert;

public class Main
{
    // Create a new instance of the ChromeDriver
    ChromeOptions options = new ChromeOptions();
    WebDriver driver = new ChromeDriver(options);
    long start = System.currentTimeMillis();
    ExtentReports extent = new ExtentReports();
    @BeforeTest
    public void initializeTest()
    {
        //defining the path where the HTML document will be created
        ExtentSparkReporter spark = new ExtentSparkReporter("index.html");
        spark.config().setTheme(Theme.DARK);
        spark.config().setDocumentTitle("My First Automation Test Report");
        spark.config().setReportName ("Extent Report");
        extent.attachReporter(spark);

        //creating first test
        ExtentTest testNav= extent.createTest("Navigate to Website");
        try
        {
            // Navigate to the login page
            driver.get("https://www.saucedemo.com/");

            int whileLimit = 0;
            String WDState = ((JavascriptExecutor) driver).executeScript("return document.readyState;").toString();
            while (!WDState.toUpperCase().equals("COMPLETE") && whileLimit < 180)
            {
                sleep(1000);
                whileLimit++;
            }
            testNav.pass("Navigation to page is successful");
            testNav.pass("URL loaded");
        } catch (Exception e) {
            System.out.println("Caught Exception: " + e.toString());
            testNav.fail("Navigation Fail");
        }
    }

    @Test
    public void Test_VerifyTitle()
    {
        //Verify if site title is correct using hard assert
        String ActualTitle = driver.getTitle();
        String ExpectedTitle = "Swag Labs";
        Assert.assertEquals(ActualTitle, ExpectedTitle);
        System.out.println("Assertion Pass: Title is " + ActualTitle);
        ExtentTest VerifyTitle= extent.createTest("Page Title Verification");
        VerifyTitle.pass("Page title verification pass");
    }

    @Test
    public void Test_Login()
    {
        ExtentTest LoginTest= extent.createTest("Login on Website");
        WebElement username = driver.findElement(By.xpath(".//*[contains(@id,'user')]"));
        username.sendKeys("standard_user");

        driver.findElement(with(By.tagName("input")).below(By.id("user-name"))).sendKeys("secret_sauce");
        driver.findElement(By.id("login-button")).click();

        // Verify that the user is logged in by checking for the presence of the inventory container using a relative locator
        WebElement inventoryContainer = driver.findElement(By.xpath("//div[@class='inventory_container']"));
        if (inventoryContainer.isDisplayed()) {
            System.out.println("Login successful!");

            LoginTest.pass("Login on website pass");
        } else
        {
            System.out.println("Login failed!");
            LoginTest.fail("Login on website fail");
        }
    }

    @Test
    public void Test_ScreenCapture()
    {
        ExtentTest VerifyProdFilter= extent.createTest("Verify Product Filter");
        try
        {
            WebElement element = driver.findElement(By.xpath(".//*[@class='inventory_item'][3]"));
            File scrFile = element.getScreenshotAs(OutputType.FILE);
            FileUtils.copyFile(scrFile, new File("./inventory_3.png"));

            //Verify if product filter is displayed using soft assert
            SoftAssert softassert = new SoftAssert();
            WebElement prodfilter = driver.findElement(By.className("product_sort_container"));
            softassert.assertEquals(true, prodfilter.isDisplayed());
            System.out.println("Assertion Pass: Product filter is displayed");
            VerifyProdFilter.pass("Product filter is present");
        }
        catch (Exception e)
        {
            System.out.println("Caught Exception: " + e.toString());
            VerifyProdFilter.fail("Product filter is not present");
        }
    }

    @AfterTest
    public void Test_Wrapup()
    {
        // browser teardown
        driver.quit();
        long finish = System.currentTimeMillis();
        // Prints: Time Elapsed for the test
        System.out.println("Time Elapsed in milliseconds: " +(finish-start));
        extent.flush();
    }
}
